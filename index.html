<!DOCTYPE html>
<html>
<head>
    <title>Iframe Test</title>
</head>
<body>
    <h1>Testing iframe execution</h1>
    <div id="status">Loading...</div>
    
    <script>
        // Immediate execution
        console.log('IFRAME TEST: Script executing');
        document.getElementById('status').innerHTML = 'JavaScript is running!';
        
        // Test iframe detection
        if (window.parent !== window) {
            console.log('IFRAME TEST: Running in iframe');
            document.getElementById('status').innerHTML += '<br>Detected: Running in iframe';
        } else {
            console.log('IFRAME TEST: Running standalone');
            document.getElementById('status').innerHTML += '<br>Detected: Running standalone';
        }
        
        // Test basic API call with fallback token
        setTimeout(async function() {
            try {
                console.log('IFRAME TEST: Attempting API call');
                const response = await fetch('https://services.leadconnectorhq.com/contacts/?locationId=jXDdl77Ej0xMJdUeEfYo', {
                    headers: {
                        'Authorization': 'Bearer pit-84c5455f-90a3-4991-b9b2-826b5c2468c1',
                        'Version': '2021-07-28'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('IFRAME TEST: API call successful', data.contacts?.length);
                    document.getElementById('status').innerHTML += `<br>API Success: Found ${data.contacts?.length} contacts`;
                } else {
                    console.log('IFRAME TEST: API call failed', response.status);
                    document.getElementById('status').innerHTML += `<br>API Failed: ${response.status}`;
                }
            } catch (error) {
                console.log('IFRAME TEST: API error', error);
                document.getElementById('status').innerHTML += `<br>API Error: ${error.message}`;
            }
        }, 1000);
    </script>
</body>
</html>
